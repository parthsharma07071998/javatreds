SELECT (CASE WHEN CDSUPPLIERFLAG='Y' THEN 'Supplier' 
WHEN CDPURCHASERFLAG = 'Y' THEN 'Purchaser'
ELSE '' END) AS RegistrationType
, (CASE WHEN CDCONSTITUTION='PROP' THEN 'Propritoryship' 
WHEN CDCONSTITUTION= 'PRIV' THEN 'Private'
WHEN CDCONSTITUTION= 'PUB' THEN 'Public'
WHEN CDCONSTITUTION= 'PART' THEN 'Partnership'
WHEN CDCONSTITUTION= 'TRST' THEN 'Trust'
WHEN CDCONSTITUTION= 'HUF' THEN 'HUF'
ELSE '' END)AS CONSTITUTION
,CDCODE CODE, CDCOMPANYNAME COMPANYNAME
, clname locationname
,TRIM(CLCITY) CITY
, TRIM(CLZIPCODE) ZIPCODE 
,TRIM(REFCODEVALUES.RCVDESC) STATE 
, clgstn GSTN,(CASE WHEN cllocationtype='R' THEN 'Registered Location' 
ELSE 'Other' END) AS LocationType,CDCUSTOMER1,CDCUSTOMER2,CDCUSTOMER3
, (CASE WHEN CDMSMEREGTYPE = 'UAN' THEN CDMSMEREGNO ELSE '' END) AS UdyogAadharNo
FROM COMPANYDETAILS,COMPANYLOCATIONS
LEFT OUTER JOIN REFCODEVALUES ON (RCVVALUE=CLSTATE AND RCVRECID=31)
WHERE CLCDID=CDID and ( CDSUPPLIERFLAG = 'Y' OR CDPURCHASERFLAG = 'Y') 
order by cdcode,LOCATIONTYPE desc
