SELECT OBFUID AS "Factoring unit id"
 ,to_char(OBDATE,'DD-MM-YYYY') AS "Transaction Date"
 ,to_char(OBSETTLEDDATE,'DD-MM-YYYY') AS "Settlement Date"
 ,to_char(FUSTATDUEDATE,'DD-MM-YYYY') AS "Due Date"
 ,a.CDCOMPANYNAME AS "Buyer Name"
 , FUPURGSTN AS "GSTN of Buyer"
 ,b.CDCOMPANYNAME AS "Seller Name"
 ,FUSUPGSTN AS "GSTN of Seller"
 ,(CASE WHEN FUCHARGEBEARER ='S' THEN 'Seller'WHEN FUCHARGEBEARER ='P' THEN 'Purchaser'ELSE '' END) AS "Cost Bearer"
,(CASE WHEN OBTYPE ='L2' THEN (OBDATE-FULEG1DATE)
 WHEN OBTYPE !='L2' THEN (FUMATURITYDATE-FULEG1DATE) ELSE NULL END) AS "Tenor"
 ,FUAMOUNT AS "FU Amount"
 ,OBTXNTYPE AS "Revenue Type"
 ,FUACCEPTEDRATE AS "Rate"
 ,FUCHARGES AS "Charges"
 ,FUIGST AS "IGST"
 ,FUCGST AS "CGST"
 ,FUSGST AS "SGST"
 ,(CASE WHEN BILID IS NOT NULL THEN 'Yes' WHEN BILID IS NULL THEN 'No'ELSE '' END) AS "Inv Generated"
 ,(CASE WHEN BILID IS NOT NULL THEN BILLS.BILBILLNUMBER ELSE '' END) AS "Inv No"
 FROM OBLIGATIONS 
 LEFT OUTER JOIN FACTORINGUNITS ON OBLIGATIONS.OBFUID=FACTORINGUNITS.FUID
 LEFT OUTER JOIN COMPANYDETAILS a ON FACTORINGUNITS.FUPURCHASER=a.CDCODE
 LEFT OUTER JOIN COMPANYDETAILS b ON FACTORINGUNITS.FUSUPPLIER=b.CDCODE
 LEFT OUTER JOIN BILLS ON OBLIGATIONS.OBBILLID=BILLS.BILID
 WHERE OBRECORDVERSION >0 AND OBTXNENTITY='TREDS' AND OBTXNTYPE='C' 
order by OBDATE desc