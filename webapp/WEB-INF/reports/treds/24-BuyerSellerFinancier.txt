SELECT CDCODE CODE,(CASE WHEN CDSUPPLIERFLAG='Y' THEN 'Supplier' 
WHEN CDPURCHASERFLAG = 'Y' THEN 'Purchaser'
WHEN CDFINANCIERFLAG = 'Y' THEN 'Financier'
ELSE '' END) AS EntityType, CDCOMPANYNAME COMPANYNAME
,TRIM(CLCITY) CITY, TRIM(CLZIPCODE) ZIPCODE ,TRIM(REFCODEVALUES.RCVDESC) STATE
FROM COMPANYDETAILS,COMPANYLOCATIONS
LEFT OUTER JOIN REFCODEVALUES ON (RCVVALUE=CLSTATE AND RCVRECID=31)
WHERE CLCDID=CDID AND CLLOCATIONTYPE='R'