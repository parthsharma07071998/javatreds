SELECT CDCODE MemberCode
, CDCOMPANYNAME CompanyName
, (CASE WHEN CDSUPPLIERFLAG='Y' THEN 'Supplier' 
WHEN CDPURCHASERFLAG = 'Y' THEN 'Purchaser' 
WHEN CDFINANCIERFLAG = 'Y' THEN 'Financier' 
ELSE '' END) AS RegistrationType
, TRIM(CDCORDISTRICT) District
,TRIM(CLLINE1)||','||TRIM(CLLINE2)||','||TRIM(CLLINE3)||','||TRIM(CLCITY)||'-'||TRIM(CLZIPCODE)||','||TRIM(CLDISTRICT)||','||TRIM(REFCODEVALUES.RCVDESC)||','||TRIM(CLCOUNTRY) AS REGISTEREDADDRESS
,TRIM(CLCITY) RegisteredCity,TRIM(CLZIPCODE) RegisteredZipCode,TRIM(REFCODEVALUES.RCVDESC) RegisteredState,TRIM(CLCOUNTRY) RegisteredCountry
,TRIM(CDCORLINE1)||','||TRIM(CDCORLINE2)||','||TRIM(CDCORLINE3)||','||TRIM(CDCORCITY)||'-'||TRIM(CDCORZIPCODE)||','||TRIM(CDCORDISTRICT)||','||TRIM(REFCODEVALUES.RCVDESC)||','||TRIM(CDCORCOUNTRY) AS CORRESPONDANCEADDRESS
,TRIM(CDCORCITY) CorrespondanceCity,TRIM(CDCORZIPCODE) CorrespondanceZipCode,TRIM(REFCODEVALUES.RCVDESC) CorrespondanceState , TRIM(CDCORCOUNTRY) CorrespondanceCountry
FROM COMPANYDETAILS,COMPANYLOCATIONS
LEFT OUTER JOIN REFCODEVALUES ON (RCVVALUE=CLSTATE AND RCVRECID=31)
WHERE CLCDID=CDID AND CLLOCATIONTYPE='R'