SELECT CDCODE CODE, CDCOMPANYNAME COMPANYNAME
, clname locationname
,TRIM(CLCITY) CITY
, TRIM(CLZIPCODE) ZIPCODE 
,TRIM(REFCODEVALUES.RCVDESC) STATE 
, clgstn GSTN,(CASE WHEN cllocationtype='R' THEN 'Registered Location' 
ELSE 'Other' END) AS LocationType,CDCUSTOMER1,CDCUSTOMER2,CDCUSTOMER3
, (CASE WHEN CDMSMEREGTYPE = 'UAN' THEN CDMSMEREGNO ELSE '' END) AS UdyogAadharNo
FROM COMPANYDETAILS,COMPANYLOCATIONS
LEFT OUTER JOIN REFCODEVALUES ON (RCVVALUE=CLSTATE AND RCVRECID=31)
WHERE CLCDID=CDID and CDSUPPLIERFLAG = 'Y'
order by cdcode,LOCATIONTYPE desc
