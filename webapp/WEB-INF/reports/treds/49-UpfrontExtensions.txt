select OBID,OBFUID fuid,OBDATE "DATE"
,OBTXNENTITY TRANSACTIONENTITY,OBTYPE TYPE
,OBAMOUNT AMOUNT,OBSTATUS STATUS,obisupfrontoblig UPFRONTOBLIG , nvl(REPLACE(OBISUPFRONT,'Y','UPFRONT'),'RAREEND') EXTTYPE
,(CASE WHEN CDSUPPLIERFLAG='Y' THEN 'Supplier' 
WHEN CDPURCHASERFLAG = 'Y' THEN 'Purchaser' 
WHEN CDFINANCIERFLAG = 'Y' THEN 'Financier' 
ELSE 'TReDS' END) AS Type from obligations 
left outer join companydetails on (OBTXNENTITY=cdcode) 
where OBEXTENDEDDAYS is not null   order by OBFUID,OBDATE 